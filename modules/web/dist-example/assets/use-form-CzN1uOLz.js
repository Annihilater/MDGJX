import{r as l,aV as ue}from"./index-XsIMaQZM.js";function ie(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const le=typeof window<"u"?l.useLayoutEffect:l.useEffect;function m(t,e){le(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function fe(t,e){t&&ie(t),m(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),m(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),m(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),m(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),m(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),m(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),m(`mantine-form:${t}:clear-errors`,e.clearErrors),m(`mantine-form:${t}:reset`,e.reset),m(`mantine-form:${t}:validate`,e.validate),m(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),m(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),m(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),m(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),m(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),m(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),m(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),m(`mantine-form:${t}:reset-touched`,e.resetTouched)}function ae(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function B(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const n=t[r];return n!=null&&n!==!1&&(e[r]=n),e},{})}function de(t){const[e,r]=l.useState(B(t)),n=l.useCallback(f=>{r(u=>B(typeof f=="function"?f(u):f))},[]),s=l.useCallback(()=>r({}),[]),c=l.useCallback(f=>{e[f]!==void 0&&n(u=>{const d={...u};return delete d[f],d})},[e]),o=l.useCallback((f,u)=>{u==null||u===!1?c(f):e[f]!==u&&n(d=>({...d,[f]:u}))},[e]);return{errorsState:e,setErrors:n,clearErrors:s,setFieldError:o,clearFieldError:c}}function G(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(n=>{n.includes(`${String(t)}.`)&&delete r[n]}),r}function X(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function Z(t,e,r,n){if(e===void 0)return r;const s=`${String(t)}`;let c=r;n===-1&&(c=G(`${s}.${e}`,c));const o={...c},f=new Set;return Object.entries(c).filter(([u])=>{if(!u.startsWith(`${s}.`))return!1;const d=X(u,s);return Number.isNaN(d)?!1:d>=e}).forEach(([u,d])=>{const j=X(u,s),g=u.replace(`${s}.${j}`,`${s}.${j+n}`);o[g]=d,f.add(g),f.has(u)||delete o[u]}),o}function be(t,{from:e,to:r},n){const s=`${t}.${e}`,c=`${t}.${r}`,o={...n};return Object.keys(n).every(f=>{let u,d;if(f.startsWith(s)&&(u=f,d=f.replace(s,c)),f.startsWith(c)&&(u=f.replace(c,s),d=f),u&&d){const j=o[u],g=o[d];return g===void 0?delete o[u]:o[u]=g,j===void 0?delete o[d]:o[d]=j,!1}return!0}),o}function J(t,e,r){typeof r.value=="object"&&(r.value=L(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function L(t){if(typeof t!="object")return t;var e=0,r,n,s,c=Object.prototype.toString.call(t);if(c==="[object Object]"?s=Object.create(t.__proto__||null):c==="[object Array]"?s=Array(t.length):c==="[object Set]"?(s=new Set,t.forEach(function(o){s.add(L(o))})):c==="[object Map]"?(s=new Map,t.forEach(function(o,f){s.set(L(f),L(o))})):c==="[object Date]"?s=new Date(+t):c==="[object RegExp]"?s=new RegExp(t.source,t.flags):c==="[object DataView]"?s=new t.constructor(L(t.buffer)):c==="[object ArrayBuffer]"?s=t.slice(0):c.slice(-6)==="Array]"&&(s=new t.constructor(t)),s){for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)J(s,n[e],Object.getOwnPropertyDescriptor(t,n[e]));for(e=0,n=Object.getOwnPropertyNames(t);e<n.length;e++)Object.hasOwnProperty.call(s,r=n[e])&&s[r]===t[r]||J(s,r,Object.getOwnPropertyDescriptor(t,r))}return s||t}function x(t){return typeof t!="string"?[]:t.split(".")}function k(t,e){const r=x(t);if(r.length===0||typeof e!="object"||e===null)return;let n=e[r[0]];for(let s=1;s<r.length&&n!==void 0;s+=1)n=n[r[s]];return n}function M(t,e,r){const n=x(t);if(n.length===0)return r;const s=L(r);if(n.length===1)return s[n[0]]=e,s;let c=s[n[0]];for(let o=1;o<n.length-1;o+=1){if(c===void 0)return s;c=c[n[o]]}return c[n[n.length-1]]=e,s}function ye(t,{from:e,to:r},n){const s=k(t,n);if(!Array.isArray(s))return n;const c=[...s],o=s[e];return c.splice(e,1),c.splice(r,0,o),M(t,c,n)}function Ee(t,e,r,n){const s=k(t,n);if(!Array.isArray(s))return n;const c=[...s];return c.splice(typeof r=="number"?r:c.length,0,e),M(t,c,n)}function Ve(t,e,r){const n=k(t,r);return Array.isArray(n)?M(t,n.filter((s,c)=>c!==e),r):r}function ge({$values:t,$errors:e,$status:r}){const n=l.useCallback((o,f)=>{r.clearFieldDirty(o),e.setErrors(u=>be(o,f,u)),t.setValues({values:ye(o,f,t.refValues.current),updateState:!0})},[]),s=l.useCallback((o,f)=>{r.clearFieldDirty(o),e.setErrors(u=>Z(o,f,u,-1)),t.setValues({values:Ve(o,f,t.refValues.current),updateState:!0})},[]),c=l.useCallback((o,f,u)=>{r.clearFieldDirty(o),e.setErrors(d=>Z(o,u,d,1)),t.setValues({values:Ee(o,f,u,t.refValues.current),updateState:!0})},[]);return{reorderListItem:n,removeListItem:s,insertListItem:c}}var Se=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,c;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(c=Object.keys(e),n=c.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,c[s]))return!1;for(s=n;s--!==0;){var o=c[s];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r};const W=ue(Se);function _(t,e){const r=Object.keys(t);if(typeof e=="string"){const n=r.filter(s=>s.startsWith(`${e}.`));return t[e]||n.some(s=>t[s])||!1}return r.some(n=>t[n])}function Fe({initialDirty:t,initialTouched:e,mode:r,$values:n}){const[s,c]=l.useState(e),[o,f]=l.useState(t),u=l.useRef(e),d=l.useRef(t),j=l.useCallback(b=>{const V=typeof b=="function"?b(u.current):b;u.current=V,r==="controlled"&&c(V)},[]),g=l.useCallback(b=>{const V=typeof b=="function"?b(d.current):b;d.current=V,r==="controlled"&&f(V)},[]),O=l.useCallback(()=>j({}),[]),E=b=>{const V=b?{...b,...n.refValues.current}:n.refValues.current;n.setValuesSnapshot(V),g({})},a=l.useCallback((b,V)=>{j(p=>_(p,b)===V?p:{...p,[b]:V})},[]),y=l.useCallback((b,V)=>{g(p=>_(p,b)===V?p:{...p,[b]:V})},[]),w=l.useCallback(b=>_(u.current,b),[]),D=l.useCallback(b=>g(V=>{if(typeof b!="string")return V;const p=G(b,V);return delete p[b],W(p,V)?V:p}),[]),h=l.useCallback(b=>{if(b){const p=k(b,d.current);if(typeof p=="boolean")return p;const I=k(b,n.refValues.current),z=k(b,n.valuesSnapshot.current);return!W(I,z)}return Object.keys(d.current).length>0?_(d.current):!W(n.refValues.current,n.valuesSnapshot.current)},[]),$=l.useCallback(()=>d.current,[]),C=l.useCallback(()=>u.current,[]);return{touchedState:s,dirtyState:o,touchedRef:u,dirtyRef:d,setTouched:j,setDirty:g,resetDirty:E,resetTouched:O,isTouched:w,setFieldTouched:a,setFieldDirty:y,setTouchedState:c,setDirtyState:f,clearFieldDirty:D,isDirty:h,getDirty:$,getTouched:C}}function me({initialValues:t,onValuesChange:e,mode:r}){const n=l.useRef(!1),[s,c]=l.useState(t||{}),o=l.useRef(s),f=l.useRef(s),u=l.useCallback(({values:a,subscribers:y,updateState:w=!0,mergeWithPreviousValues:D=!0})=>{const h=o.current,$=a instanceof Function?a(o.current):a,C=D?{...h,...$}:$;o.current=C,w&&c(C),e==null||e(C,h),y==null||y.filter(Boolean).forEach(b=>b({updatedValues:C,previousValues:h}))},[e]),d=l.useCallback(a=>{var D;const y=k(a.path,o.current),w=a.value instanceof Function?a.value(y):a.value;if(y!==w){const h=o.current,$=M(a.path,w,o.current);u({values:$,updateState:a.updateState}),(D=a.subscribers)==null||D.filter(Boolean).forEach(C=>C({path:a.path,updatedValues:$,previousValues:h}))}},[]),j=l.useCallback(a=>{f.current=a},[]),g=l.useCallback((a,y)=>{n.current||(n.current=!0,u({values:a,updateState:r==="controlled"}),j(a),y())},[]),O=l.useCallback(()=>{u({values:f.current,updateState:!0,mergeWithPreviousValues:!1})},[]),E=l.useCallback(()=>o.current,[]);return{initialized:n,stateValues:s,refValues:o,valuesSnapshot:f,setValues:u,setFieldValue:d,resetValues:O,setValuesSnapshot:j,initialize:g,getValues:E}}function je({$status:t}){const e=l.useRef({}),r=l.useCallback((s,c)=>{l.useEffect(()=>(e.current[s]=e.current[s]||[],e.current[s].push(c),()=>{e.current[s]=e.current[s].filter(o=>o!==c)}),[c])},[]),n=l.useCallback(s=>e.current[s]?e.current[s].map(c=>o=>c({previousValue:k(s,o.previousValues),value:k(s,o.updatedValues),touched:t.isTouched(s),dirty:t.isDirty(s)})):[],[]);return{subscribers:e,watch:r,getFieldSubscribers:n}}function Q(t){const e=B(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function q(t,e,r="",n={}){return typeof t!="object"||t===null?n:Object.keys(t).reduce((s,c)=>{const o=t[c],f=`${r===""?"":`${r}.`}${c}`,u=k(f,e);let d=!1;return typeof o=="function"&&(s[f]=o(u,e,f)),typeof o=="object"&&Array.isArray(u)&&(d=!0,u.forEach((j,g)=>q(o,e,`${f}.${g}`,s))),typeof o=="object"&&typeof u=="object"&&u!==null&&(d||q(o,e,f,s)),s},n)}function H(t,e){return Q(typeof t=="function"?t(e):q(t,e))}function N(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const n=H(e,r),s=Object.keys(n.errors).find(c=>t.split(".").every((o,f)=>o===c.split(".")[f]));return{hasError:!!s,error:s?n.errors[s]:null}}const pe="__MANTINE_FORM_INDEX__";function Y(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]/g,`.${pe}`)):!1:!1}function ke({name:t,mode:e="controlled",initialValues:r,initialErrors:n={},initialDirty:s={},initialTouched:c={},clearInputErrorOnChange:o=!0,validateInputOnChange:f=!1,validateInputOnBlur:u=!1,onValuesChange:d,transformValues:j=E=>E,enhanceGetInputProps:g,validate:O}={}){const E=de(n),a=me({initialValues:r,onValuesChange:d,mode:e}),y=Fe({initialDirty:s,initialTouched:c,$values:a,mode:e}),w=ge({$values:a,$errors:E,$status:y}),D=je({$status:y}),[h,$]=l.useState(0),[C,b]=l.useState({}),V=l.useCallback(()=>{a.resetValues(),E.clearErrors(),y.resetDirty(),y.resetTouched(),e==="uncontrolled"&&$(i=>i+1)},[]),p=l.useCallback(i=>{a.initialize(i,()=>e==="uncontrolled"&&$(F=>F+1))},[]),I=l.useCallback((i,F,S)=>{const T=Y(i,f);y.clearFieldDirty(i),y.setFieldTouched(i,!0),!T&&o&&E.clearFieldError(i),a.setFieldValue({path:i,value:F,updateState:e==="controlled",subscribers:[...D.getFieldSubscribers(i),T?v=>{const R=N(i,O,v.updatedValues);R.hasError?E.setFieldError(i,R.error):E.clearFieldError(i)}:null,(S==null?void 0:S.forceUpdate)!==!1&&e!=="controlled"?()=>b(v=>({...v,[i]:(v[i]||0)+1})):null]})},[d,O]),z=l.useCallback(i=>{const F=a.refValues.current;a.setValues({values:i,updateState:e==="controlled"}),o&&E.clearErrors(),e==="uncontrolled"&&$(S=>S+1),Object.keys(D.subscribers.current).forEach(S=>{const T=k(S,a.refValues.current),v=k(S,F);T!==v&&D.getFieldSubscribers(S).forEach(R=>R({previousValues:F,updatedValues:a.refValues.current}))})},[d,o]),U=l.useCallback(()=>{const i=H(O,a.refValues.current);return E.setErrors(i.errors),i},[O]),ee=l.useCallback(i=>{const F=N(i,O,a.refValues.current);return F.hasError?E.setFieldError(i,F.error):E.clearFieldError(i),F},[O]),te=(i,{type:F="input",withError:S=!0,withFocus:T=!0,...v}={})=>{const A={onChange:ae(P=>I(i,P,{forceUpdate:!1}))};return S&&(A.error=E.errorsState[i]),F==="checkbox"?A[e==="controlled"?"checked":"defaultChecked"]=k(i,a.refValues.current):A[e==="controlled"?"value":"defaultValue"]=k(i,a.refValues.current),T&&(A.onFocus=()=>y.setFieldTouched(i,!0),A.onBlur=()=>{if(Y(i,u)){const P=N(i,O,a.refValues.current);P.hasError?E.setFieldError(i,P.error):E.clearFieldError(i)}}),Object.assign(A,g==null?void 0:g({inputProps:A,field:i,options:{type:F,withError:S,withFocus:T,...v},form:K}))},re=(i,F)=>S=>{S==null||S.preventDefault();const T=U();T.hasErrors?F==null||F(T.errors,a.refValues.current,S):i==null||i(j(a.refValues.current),S)},se=i=>j(i||a.refValues.current),ne=l.useCallback(i=>{i.preventDefault(),V()},[]),oe=l.useCallback(i=>i?!N(i,O,a.refValues.current).hasError:!H(O,a.refValues.current).hasErrors,[O]),ce=i=>`${h}-${i}-${C[i]||0}`,K={watch:D.watch,initialized:a.initialized.current,values:a.stateValues,getValues:a.getValues,setInitialValues:a.setValuesSnapshot,initialize:p,setValues:z,setFieldValue:I,errors:E.errorsState,setErrors:E.setErrors,setFieldError:E.setFieldError,clearFieldError:E.clearFieldError,clearErrors:E.clearErrors,resetDirty:y.resetDirty,setTouched:y.setTouched,setDirty:y.setDirty,isTouched:y.isTouched,resetTouched:y.resetTouched,isDirty:y.isDirty,getTouched:y.getTouched,getDirty:y.getDirty,reorderListItem:w.reorderListItem,insertListItem:w.insertListItem,removeListItem:w.removeListItem,reset:V,validate:U,validateField:ee,getInputProps:te,onSubmit:re,onReset:ne,isValid:oe,getTransformedValues:se,key:ce};return fe(t,K),K}export{ke as u};
