import{r as reactExports,n as createSafeContext,o as factory,p as useProps,q as useFocusReturn,s as useMergedRef,R as React,O as OptionalPortal,v as Transition,F as FocusTrap,w as Box,k as rem,x as FloatingArrow,y as isElement,z as clsx,A as useUncontrolled,D as useFloating,E as useFloatingAutoUpdate,H as useDidUpdate,J as offset,K as shift,M as limitShift,N as flip,P as inline,Q as arrow,U as size,V as getDefaultZIndex,W as useStyles,X as useDirection,Y as useId,Z as getFloatingPosition,$ as createVarsResolver,a0 as getRadius,a1 as getShadow,a2 as getSize,a3 as CloseButton,a4 as Input,a5 as getFontSize,a6 as assignRef,a7 as InputBase,c as createReactComponent,j as jsxRuntimeExports,B as Button,a8 as Tooltip,m as apiSlice,_,a9 as AlertUtils,aa as Group,a as Text,ab as exportUtils,ac as useWebsocket,C as Container,ad as Blink,ae as readStrFromFile}from"./index-XsIMaQZM.js";import{C as CheckIcon,F as Flex}from"./CheckIcon-Cefj2HfO.js";import{S as ScrollArea,u as useResolvedStylesApi,a as useDebouncedCallback,T as Table}from"./Table-Uv2kxH-W.js";import{C as Card}from"./Card-DY0iFTfs.js";import{u as useClipboard,j as js_export_trigger}from"./FileExportUtils-VJa0cFX8.js";import{T as Textarea}from"./Textarea-CU0mPiDu.js";const noop=()=>{};function closeOnEscape(e,r={active:!0}){return typeof e!="function"||!r.active?r.onKeyDown||noop:o=>{var s;o.key==="Escape"&&(e(o),(s=r.onTrigger)==null||s.call(r))}}const DEFAULT_EVENTS=["mousedown","touchstart"];function useClickOutside(e,r,o){const s=reactExports.useRef();return reactExports.useEffect(()=>{const a=t=>{const{target:n}=t??{};if(Array.isArray(o)){const l=(n==null?void 0:n.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(n)&&n.tagName!=="HTML";o.every(u=>!!u&&!t.composedPath().includes(u))&&!l&&e()}else s.current&&!s.current.contains(n)&&e()};return(r||DEFAULT_EVENTS).forEach(t=>document.addEventListener(t,a)),()=>{(r||DEFAULT_EVENTS).forEach(t=>document.removeEventListener(t,a))}},[s,e,o]),s}const[PopoverContextProvider,usePopoverContext]=createSafeContext("Popover component was not found in the tree");var classes$1={dropdown:"m_38a85659",arrow:"m_a31dc6c1"};const defaultProps$h={},PopoverDropdown=factory((e,r)=>{var w,g,C,y;const o=useProps("PopoverDropdown",defaultProps$h,e),{className:s,style:a,vars:t,children:n,onKeyDownCapture:l,variant:c,classNames:u,styles:x,...d}=o,i=usePopoverContext(),f=useFocusReturn({opened:i.opened,shouldReturnFocus:i.returnFocus}),v=i.withRoles?{"aria-labelledby":i.getTargetId(),id:i.getDropdownId(),role:"dialog",tabIndex:-1}:{},R=useMergedRef(r,i.floating);return i.disabled?null:React.createElement(OptionalPortal,{...i.portalProps,withinPortal:i.withinPortal},React.createElement(Transition,{mounted:i.opened,...i.transitionProps,transition:((w=i.transitionProps)==null?void 0:w.transition)||"fade",duration:((g=i.transitionProps)==null?void 0:g.duration)??150,keepMounted:i.keepMounted,exitDuration:typeof((C=i.transitionProps)==null?void 0:C.exitDuration)=="number"?i.transitionProps.exitDuration:(y=i.transitionProps)==null?void 0:y.duration},h=>React.createElement(FocusTrap,{active:i.trapFocus},React.createElement(Box,{...v,...d,variant:c,ref:R,onKeyDownCapture:closeOnEscape(i.onClose,{active:i.closeOnEscape,onTrigger:f,onKeyDown:l}),"data-position":i.placement,...i.getStyles("dropdown",{className:s,props:o,classNames:u,styles:x,style:[{...h,zIndex:i.zIndex,top:i.y??0,left:i.x??0,width:i.width==="target"?void 0:rem(i.width)},a]})},n,React.createElement(FloatingArrow,{ref:i.arrowRef,arrowX:i.arrowX,arrowY:i.arrowY,visible:i.withArrow,position:i.placement,arrowSize:i.arrowSize,arrowRadius:i.arrowRadius,arrowOffset:i.arrowOffset,arrowPosition:i.arrowPosition,...i.getStyles("arrow",{props:o,classNames:u,styles:x})})))))});PopoverDropdown.classes=classes$1;PopoverDropdown.displayName="@mantine/core/PopoverDropdown";const defaultProps$g={refProp:"ref",popupType:"dialog"},PopoverTarget=factory((e,r)=>{const{children:o,refProp:s,popupType:a,...t}=useProps("PopoverTarget",defaultProps$g,e);if(!isElement(o))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const n=t,l=usePopoverContext(),c=useMergedRef(l.reference,o.ref,r),u=l.withRoles?{"aria-haspopup":a,"aria-expanded":l.opened,"aria-controls":l.getDropdownId(),id:l.getTargetId()}:{};return reactExports.cloneElement(o,{...n,...u,...l.targetProps,className:clsx(l.targetProps.className,n.className,o.props.className),[s]:c,...l.controlled?null:{onClick:l.onToggle}})});PopoverTarget.displayName="@mantine/core/PopoverTarget";function getDefaultMiddlewares(e){if(e===void 0)return{shift:!0,flip:!0};const r={...e};return e.shift===void 0&&(r.shift=!0),e.flip===void 0&&(r.flip=!0),r}function getPopoverMiddlewares(e,r){const o=getDefaultMiddlewares(e.middlewares),s=[offset(e.offset)];return o.shift&&s.push(shift(typeof o.shift=="boolean"?{limiter:limitShift(),padding:5}:{limiter:limitShift(),padding:5,...o.shift})),o.flip&&s.push(typeof o.flip=="boolean"?flip():flip(o.flip)),o.inline&&s.push(typeof o.inline=="boolean"?inline():inline(o.inline)),s.push(arrow({element:e.arrowRef,padding:e.arrowOffset})),(o.size||e.width==="target")&&s.push(size({...typeof o.size=="boolean"?{}:o.size,apply({rects:a,availableWidth:t,availableHeight:n}){var u;const c=((u=r().refs.floating.current)==null?void 0:u.style)??{};o.size&&Object.assign(c,{maxWidth:`${t}px`,maxHeight:`${n}px`}),e.width==="target"&&Object.assign(c,{width:`${a.reference.width}px`})}})),s}function usePopover(e){const[r,o]=useUncontrolled({value:e.opened,defaultValue:e.defaultOpened,finalValue:!1,onChange:e.onChange}),s=()=>{var n;r&&((n=e.onClose)==null||n.call(e),o(!1))},a=()=>{var n,l;r?((n=e.onClose)==null||n.call(e),o(!1)):((l=e.onOpen)==null||l.call(e),o(!0))},t=useFloating({strategy:e.strategy,placement:e.position,middleware:getPopoverMiddlewares(e,()=>t)});return useFloatingAutoUpdate({opened:e.opened,position:e.position,positionDependencies:e.positionDependencies||[],floating:t}),useDidUpdate(()=>{var n;(n=e.onPositionChange)==null||n.call(e,t.placement)},[t.placement]),useDidUpdate(()=>{var n,l;e.opened?(l=e.onOpen)==null||l.call(e):(n=e.onClose)==null||n.call(e)},[e.opened]),{floating:t,controlled:typeof e.opened=="boolean",opened:r,onClose:s,onToggle:a}}const defaultProps$f={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:getDefaultZIndex("popover"),__staticSelector:"Popover",width:"max-content"},varsResolver$2=createVarsResolver((e,{radius:r,shadow:o})=>({dropdown:{"--popover-radius":r===void 0?void 0:getRadius(r),"--popover-shadow":getShadow(o)}}));function Popover(e){var D,re,ae,J,te,H;const r=useProps("Popover",defaultProps$f,e),{children:o,position:s,offset:a,onPositionChange:t,positionDependencies:n,opened:l,transitionProps:c,width:u,middlewares:x,withArrow:d,arrowSize:i,arrowOffset:f,arrowRadius:v,arrowPosition:R,unstyled:w,classNames:g,styles:C,closeOnClickOutside:y,withinPortal:h,portalProps:P,closeOnEscape:L,clickOutsideEvents:q,trapFocus:W,onClose:Y,onOpen:Z,onChange:M,zIndex:m,radius:p,shadow:F,id:A,defaultOpened:b,__staticSelector:S,withRoles:E,disabled:j,returnFocus:z,variant:N,keepMounted:I,vars:B,floatingStrategy:V,...U}=r,k=useStyles({name:S,props:r,classes:classes$1,classNames:g,styles:C,unstyled:w,rootSelector:"dropdown",vars:B,varsResolver:varsResolver$2}),K=reactExports.useRef(null),[X,ee]=reactExports.useState(null),[oe,le]=reactExports.useState(null),{dir:ie}=useDirection(),se=useId(A),O=usePopover({middlewares:x,width:u,position:getFloatingPosition(ie,s),offset:typeof a=="number"?a+(d?i/2:0):a,arrowRef:K,arrowOffset:f,onPositionChange:t,positionDependencies:n,opened:l,defaultOpened:b,onChange:M,onOpen:Z,onClose:Y,strategy:V});useClickOutside(()=>y&&O.onClose(),q,[X,oe]);const Q=reactExports.useCallback(T=>{ee(T),O.floating.refs.setReference(T)},[O.floating.refs.setReference]),ne=reactExports.useCallback(T=>{le(T),O.floating.refs.setFloating(T)},[O.floating.refs.setFloating]);return React.createElement(PopoverContextProvider,{value:{returnFocus:z,disabled:j,controlled:O.controlled,reference:Q,floating:ne,x:O.floating.x,y:O.floating.y,arrowX:(ae=(re=(D=O.floating)==null?void 0:D.middlewareData)==null?void 0:re.arrow)==null?void 0:ae.x,arrowY:(H=(te=(J=O.floating)==null?void 0:J.middlewareData)==null?void 0:te.arrow)==null?void 0:H.y,opened:O.opened,arrowRef:K,transitionProps:c,width:u,withArrow:d,arrowSize:i,arrowOffset:f,arrowRadius:v,arrowPosition:R,placement:O.floating.placement,trapFocus:W,withinPortal:h,portalProps:P,zIndex:m,radius:p,shadow:F,closeOnEscape:L,onClose:O.onClose,onToggle:O.onToggle,getTargetId:()=>`${se}-target`,getDropdownId:()=>`${se}-dropdown`,withRoles:E,targetProps:U,__staticSelector:S,classNames:g,styles:C,unstyled:w,variant:N,keepMounted:I,getStyles:k}},o)}Popover.Target=PopoverTarget;Popover.Dropdown=PopoverDropdown;Popover.displayName="@mantine/core/Popover";Popover.extend=e=>e;function parseItem(e){return typeof e=="string"?{value:e,label:e}:"value"in e&&!("label"in e)?{value:e.value,label:e.value,disabled:e.disabled}:typeof e=="number"?{value:e.toString(),label:e.toString()}:"group"in e?{group:e.group,items:e.items.map(r=>parseItem(r))}:e}function getParsedComboboxData(e){return e?e.map(r=>parseItem(r)):[]}function getOptionsLockup(e){return e.reduce((r,o)=>"group"in o?{...r,...getOptionsLockup(o.items)}:(r[o.value]=o,r),{})}var classes={dropdown:"m_88b62a41",options:"m_b2821a6e",option:"m_92253aa5",search:"m_985517d8",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2"};const defaultProps$e={error:null},varsResolver$1=createVarsResolver((e,{size:r})=>({chevron:{"--combobox-chevron-size":getSize(r,"combobox-chevron-size")}})),ComboboxChevron=factory((e,r)=>{const o=useProps("ComboboxChevron",defaultProps$e,e),{size:s,error:a,style:t,className:n,classNames:l,styles:c,unstyled:u,vars:x,mod:d,...i}=o,f=useStyles({name:"ComboboxChevron",classes,props:o,style:t,className:n,classNames:l,styles:c,unstyled:u,vars:x,varsResolver:varsResolver$1,rootSelector:"chevron"});return React.createElement(Box,{component:"svg",...i,...f("chevron"),size:s,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:a},d],ref:r},React.createElement("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))});ComboboxChevron.classes=classes;ComboboxChevron.displayName="@mantine/core/ComboboxChevron";const[ComboboxProvider,useComboboxContext]=createSafeContext("Combobox component was not found in tree"),ComboboxClearButton=reactExports.forwardRef(({size:e,onMouseDown:r,onClick:o,onClear:s,...a},t)=>React.createElement(CloseButton,{ref:t,size:e||"sm",variant:"transparent",tabIndex:-1,"aria-hidden":!0,...a,onMouseDown:n=>{n.preventDefault(),r==null||r(n)},onClick:n=>{s(),o==null||o(n)}}));ComboboxClearButton.displayName="@mantine/core/ComboboxClearButton";const defaultProps$d={},ComboboxDropdown=factory((e,r)=>{const{classNames:o,styles:s,className:a,style:t,hidden:n,...l}=useProps("ComboboxDropdown",defaultProps$d,e),c=useComboboxContext();return React.createElement(Popover.Dropdown,{...l,ref:r,role:"presentation","data-hidden":n||void 0,...c.getStyles("dropdown",{className:a,style:t,classNames:o,styles:s})})});ComboboxDropdown.classes=classes;ComboboxDropdown.displayName="@mantine/core/ComboboxDropdown";const defaultProps$c={refProp:"ref"},ComboboxDropdownTarget=factory((e,r)=>{const{children:o,refProp:s}=useProps("ComboboxDropdownTarget",defaultProps$c,e);if(useComboboxContext(),!isElement(o))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return React.createElement(Popover.Target,{ref:r,refProp:s},o)});ComboboxDropdownTarget.displayName="@mantine/core/ComboboxDropdownTarget";const defaultProps$b={},ComboboxEmpty=factory((e,r)=>{const{classNames:o,className:s,style:a,styles:t,vars:n,...l}=useProps("ComboboxEmpty",defaultProps$b,e),c=useComboboxContext();return React.createElement(Box,{ref:r,...c.getStyles("empty",{className:s,classNames:o,styles:t,style:a}),...l})});ComboboxEmpty.classes=classes;ComboboxEmpty.displayName="@mantine/core/ComboboxEmpty";function useComboboxTargetProps({onKeyDown:e,withKeyboardNavigation:r,withAriaAttributes:o,withExpandedAttribute:s,targetType:a,autoComplete:t}){const n=useComboboxContext(),[l,c]=reactExports.useState(null),u=d=>{if(e==null||e(d),!n.readOnly&&r){if(d.nativeEvent.isComposing)return;if(d.nativeEvent.code==="ArrowDown"&&(d.preventDefault(),n.store.dropdownOpened?c(n.store.selectNextOption()):(n.store.openDropdown("keyboard"),c(n.store.selectActiveOption()))),d.nativeEvent.code==="ArrowUp"&&(d.preventDefault(),n.store.dropdownOpened?c(n.store.selectPreviousOption()):(n.store.openDropdown("keyboard"),c(n.store.selectActiveOption()))),d.nativeEvent.code==="Enter"||d.nativeEvent.code==="NumpadEnter"){if(d.nativeEvent.keyCode===229)return;const i=n.store.getSelectedOptionIndex();n.store.dropdownOpened&&i!==-1?(d.preventDefault(),n.store.clickSelectedOption()):a==="button"&&(d.preventDefault(),n.store.openDropdown("keyboard"))}d.nativeEvent.code==="Escape"&&n.store.closeDropdown("keyboard"),d.nativeEvent.code==="Space"&&a==="button"&&(d.preventDefault(),n.store.toggleDropdown("keyboard"))}};return{...o?{"aria-haspopup":"listbox","aria-expanded":s&&!!(n.store.listId&&n.store.dropdownOpened)||void 0,"aria-controls":n.store.listId,"aria-activedescendant":n.store.dropdownOpened&&l||void 0,autoComplete:t,"data-expanded":n.store.dropdownOpened||void 0,"data-mantine-stop-propagation":n.store.dropdownOpened||void 0}:{},onKeyDown:u}}const defaultProps$a={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},ComboboxEventsTarget=factory((e,r)=>{const{children:o,refProp:s,withKeyboardNavigation:a,withAriaAttributes:t,withExpandedAttribute:n,targetType:l,autoComplete:c,...u}=useProps("ComboboxEventsTarget",defaultProps$a,e);if(!isElement(o))throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const x=useComboboxContext(),d=useComboboxTargetProps({targetType:l,withAriaAttributes:t,withKeyboardNavigation:a,withExpandedAttribute:n,onKeyDown:o.props.onKeyDown,autoComplete:c});return reactExports.cloneElement(o,{...d,...u,[s]:useMergedRef(r,x.store.targetRef,o==null?void 0:o.ref)})});ComboboxEventsTarget.displayName="@mantine/core/ComboboxEventsTarget";const defaultProps$9={},ComboboxFooter=factory((e,r)=>{const{classNames:o,className:s,style:a,styles:t,vars:n,...l}=useProps("ComboboxFooter",defaultProps$9,e),c=useComboboxContext();return React.createElement(Box,{ref:r,...c.getStyles("footer",{className:s,classNames:o,style:a,styles:t}),...l})});ComboboxFooter.classes=classes;ComboboxFooter.displayName="@mantine/core/ComboboxFooter";const defaultProps$8={},ComboboxGroup=factory((e,r)=>{const{classNames:o,className:s,style:a,styles:t,vars:n,children:l,label:c,...u}=useProps("ComboboxGroup",defaultProps$8,e),x=useComboboxContext();return React.createElement(Box,{ref:r,...x.getStyles("group",{className:s,classNames:o,style:a,styles:t}),...u},c&&React.createElement("div",{...x.getStyles("groupLabel",{classNames:o,styles:t})},c),l)});ComboboxGroup.classes=classes;ComboboxGroup.displayName="@mantine/core/ComboboxGroup";const defaultProps$7={},ComboboxHeader=factory((e,r)=>{const{classNames:o,className:s,style:a,styles:t,vars:n,...l}=useProps("ComboboxHeader",defaultProps$7,e),c=useComboboxContext();return React.createElement(Box,{ref:r,...c.getStyles("header",{className:s,classNames:o,style:a,styles:t}),...l})});ComboboxHeader.classes=classes;ComboboxHeader.displayName="@mantine/core/ComboboxHeader";function ComboboxHiddenInput({value:e,valuesDivider:r=",",...o}){return React.createElement("input",{type:"hidden",value:Array.isArray(e)?e.join(r):e||"",...o})}ComboboxHiddenInput.displayName="@mantine/core/ComboboxHiddenInput";const defaultProps$6={},ComboboxOption=factory((e,r)=>{const o=useProps("ComboboxOption",defaultProps$6,e),{classNames:s,className:a,style:t,styles:n,vars:l,onClick:c,id:u,active:x,onMouseDown:d,onMouseOver:i,disabled:f,selected:v,mod:R,...w}=o,g=useComboboxContext(),C=reactExports.useId(),y=u||C;return React.createElement(Box,{...g.getStyles("option",{className:a,classNames:s,styles:n,style:t}),...w,ref:r,id:y,mod:["combobox-option",{"combobox-active":x,"combobox-disabled":f,"combobox-selected":v},R],role:"option",onClick:h=>{var P;f?h.preventDefault():((P=g.onOptionSubmit)==null||P.call(g,o.value,o),c==null||c(h))},onMouseDown:h=>{h.preventDefault(),d==null||d(h)},onMouseOver:h=>{g.resetSelectionOnOptionHover&&g.store.resetSelectedOption(),i==null||i(h)}})});ComboboxOption.classes=classes;ComboboxOption.displayName="@mantine/core/ComboboxOption";const defaultProps$5={},ComboboxOptions=factory((e,r)=>{const o=useProps("ComboboxOptions",defaultProps$5,e),{classNames:s,className:a,style:t,styles:n,id:l,onMouseDown:c,labelledBy:u,...x}=o,d=useComboboxContext(),i=useId(l);return reactExports.useEffect(()=>{d.store.setListId(i)},[i]),React.createElement(Box,{ref:r,...d.getStyles("options",{className:a,style:t,classNames:s,styles:n}),...x,id:i,role:"listbox","aria-labelledby":u,onMouseDown:f=>{f.preventDefault(),c==null||c(f)}})});ComboboxOptions.classes=classes;ComboboxOptions.displayName="@mantine/core/ComboboxOptions";const defaultProps$4={withAriaAttributes:!0,withKeyboardNavigation:!0},ComboboxSearch=factory((e,r)=>{const o=useProps("ComboboxSearch",defaultProps$4,e),{classNames:s,styles:a,unstyled:t,vars:n,withAriaAttributes:l,onKeyDown:c,withKeyboardNavigation:u,size:x,...d}=o,i=useComboboxContext(),f=i.getStyles("search"),v=useComboboxTargetProps({targetType:"input",withAriaAttributes:l,withKeyboardNavigation:u,withExpandedAttribute:!1,onKeyDown:c,autoComplete:"off"});return React.createElement(Input,{ref:useMergedRef(r,i.store.searchRef),classNames:[{input:f.className},s],styles:[{input:f.style},a],size:x||i.size,...v,...d,__staticSelector:"Combobox"})});ComboboxSearch.classes=classes;ComboboxSearch.displayName="@mantine/core/ComboboxSearch";const defaultProps$3={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},ComboboxTarget=factory((e,r)=>{const{children:o,refProp:s,withKeyboardNavigation:a,withAriaAttributes:t,withExpandedAttribute:n,targetType:l,autoComplete:c,...u}=useProps("ComboboxTarget",defaultProps$3,e);if(!isElement(o))throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const x=useComboboxContext(),d=useComboboxTargetProps({targetType:l,withAriaAttributes:t,withKeyboardNavigation:a,withExpandedAttribute:n,onKeyDown:o.props.onKeyDown,autoComplete:c}),i=reactExports.cloneElement(o,{...d,...u});return React.createElement(Popover.Target,{ref:useMergedRef(r,x.store.targetRef)},i)});ComboboxTarget.displayName="@mantine/core/ComboboxTarget";function getPreviousIndex(e,r,o){for(let s=e-1;s>=0;s-=1)if(!r[s].hasAttribute("data-combobox-disabled"))return s;if(o){for(let s=r.length-1;s>-1;s-=1)if(!r[s].hasAttribute("data-combobox-disabled"))return s}return e}function getNextIndex(e,r,o){for(let s=e+1;s<r.length;s+=1)if(!r[s].hasAttribute("data-combobox-disabled"))return s;if(o){for(let s=0;s<r.length;s+=1)if(!r[s].hasAttribute("data-combobox-disabled"))return s}return e}function getFirstIndex(e){for(let r=0;r<e.length;r+=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r;return-1}function useCombobox({defaultOpened:e,opened:r,onOpenedChange:o,onDropdownClose:s,onDropdownOpen:a,loop:t=!0,scrollBehavior:n="instant"}={}){const[l,c]=useUncontrolled({value:r,defaultValue:e,finalValue:!1,onChange:o}),u=reactExports.useRef(null),x=reactExports.useRef(-1),d=reactExports.useRef(null),i=reactExports.useRef(null),f=reactExports.useRef(-1),v=reactExports.useRef(-1),R=reactExports.useRef(-1),w=reactExports.useCallback((b="unknown")=>{l||(c(!0),a==null||a(b))},[c,a,l]),g=reactExports.useCallback((b="unknown")=>{l&&(c(!1),s==null||s(b))},[c,s,l]),C=reactExports.useCallback((b="unknown")=>{l?g(b):w(b)},[g,w,l]),y=reactExports.useCallback(()=>{const b=document.querySelector(`#${u.current} [data-combobox-selected]`);b==null||b.removeAttribute("data-combobox-selected"),b==null||b.removeAttribute("aria-selected")},[]),h=reactExports.useCallback(b=>{const S=document.getElementById(u.current),E=S==null?void 0:S.querySelectorAll("[data-combobox-option]");if(!E)return null;const j=b>=E.length?0:b<0?E.length-1:b;return x.current=j,E!=null&&E[j]&&!E[j].hasAttribute("data-combobox-disabled")?(y(),E[j].setAttribute("data-combobox-selected","true"),E[j].setAttribute("aria-selected","true"),E[j].scrollIntoView({block:"nearest",behavior:n}),E[j].id):null},[n,y]),P=reactExports.useCallback(()=>{const b=document.querySelector(`#${u.current} [data-combobox-active]`);if(b){const S=document.querySelectorAll(`#${u.current} [data-combobox-option]`),E=Array.from(S).findIndex(j=>j===b);return h(E)}return h(0)},[h]),L=reactExports.useCallback(()=>h(getNextIndex(x.current,document.querySelectorAll(`#${u.current} [data-combobox-option]`),t)),[h,t]),q=reactExports.useCallback(()=>h(getPreviousIndex(x.current,document.querySelectorAll(`#${u.current} [data-combobox-option]`),t)),[h,t]),W=reactExports.useCallback(()=>h(getFirstIndex(document.querySelectorAll(`#${u.current} [data-combobox-option]`))),[h]),Y=reactExports.useCallback((b="selected",S)=>{R.current=window.setTimeout(()=>{var z;const E=document.querySelectorAll(`#${u.current} [data-combobox-option]`),j=Array.from(E).findIndex(N=>N.hasAttribute(`data-combobox-${b}`));x.current=j,S!=null&&S.scrollIntoView&&((z=E[j])==null||z.scrollIntoView({block:"nearest",behavior:n}))},0)},[]),Z=reactExports.useCallback(()=>{x.current=-1,y()},[y]),M=reactExports.useCallback(()=>{const b=document.querySelectorAll(`#${u.current} [data-combobox-option]`),S=b==null?void 0:b[x.current];S==null||S.click()},[]),m=reactExports.useCallback(b=>{u.current=b},[]),p=reactExports.useCallback(()=>{f.current=window.setTimeout(()=>d.current.focus(),0)},[]),F=reactExports.useCallback(()=>{v.current=window.setTimeout(()=>i.current.focus(),0)},[]),A=reactExports.useCallback(()=>x.current,[]);return reactExports.useEffect(()=>()=>{window.clearTimeout(f.current),window.clearTimeout(v.current),window.clearTimeout(R.current)},[]),{dropdownOpened:l,openDropdown:w,closeDropdown:g,toggleDropdown:C,selectedOptionIndex:x.current,getSelectedOptionIndex:A,selectOption:h,selectFirstOption:W,selectActiveOption:P,selectNextOption:L,selectPreviousOption:q,resetSelectedOption:Z,updateSelectedOptionIndex:Y,listId:u.current,setListId:m,clickSelectedOption:M,searchRef:d,focusSearchInput:p,targetRef:i,focusTarget:F}}const defaultProps$2={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0}},varsResolver=createVarsResolver((e,{size:r,dropdownPadding:o})=>({options:{"--combobox-option-fz":getFontSize(r),"--combobox-option-padding":getSize(r,"combobox-option-padding")},dropdown:{"--combobox-padding":o===void 0?void 0:rem(o),"--combobox-option-fz":getFontSize(r),"--combobox-option-padding":getSize(r,"combobox-option-padding")}}));function Combobox(e){const r=useProps("Combobox",defaultProps$2,e),{classNames:o,styles:s,unstyled:a,children:t,store:n,vars:l,onOptionSubmit:c,onClose:u,size:x,dropdownPadding:d,resetSelectionOnOptionHover:i,__staticSelector:f,readOnly:v,...R}=r,w=useCombobox(),g=n||w,C=useStyles({name:f||"Combobox",classes,props:r,classNames:o,styles:s,unstyled:a,vars:l,varsResolver}),y=()=>{u==null||u(),g.closeDropdown()};return React.createElement(ComboboxProvider,{value:{getStyles:C,store:g,onOptionSubmit:c,size:x,resetSelectionOnOptionHover:i,readOnly:v}},React.createElement(Popover,{opened:g.dropdownOpened,...R,onClose:y,withRoles:!1,unstyled:a},t))}const extendCombobox=e=>e;Combobox.extend=extendCombobox;Combobox.classes=classes;Combobox.displayName="@mantine/core/Combobox";Combobox.Target=ComboboxTarget;Combobox.Dropdown=ComboboxDropdown;Combobox.Options=ComboboxOptions;Combobox.Option=ComboboxOption;Combobox.Search=ComboboxSearch;Combobox.Empty=ComboboxEmpty;Combobox.Chevron=ComboboxChevron;Combobox.Footer=ComboboxFooter;Combobox.Header=ComboboxHeader;Combobox.EventsTarget=ComboboxEventsTarget;Combobox.DropdownTarget=ComboboxDropdownTarget;Combobox.Group=ComboboxGroup;Combobox.ClearButton=ComboboxClearButton;Combobox.HiddenInput=ComboboxHiddenInput;function isOptionsGroup(e){return"group"in e}function defaultOptionsFilter({options:e,search:r,limit:o}){const s=r.trim().toLowerCase(),a=[];for(let t=0;t<e.length;t+=1){const n=e[t];if(a.length===o)return a;isOptionsGroup(n)&&a.push({group:n.group,items:defaultOptionsFilter({options:n.items,search:r,limit:o-a.length})}),isOptionsGroup(n)||n.label.toLowerCase().includes(s)&&a.push(n)}return a}function isEmptyComboboxData(e){if(e.length===0)return!0;for(const r of e)if(!("group"in r)||r.items.length>0)return!1;return!0}function validateOptions(e,r=new Set){if(Array.isArray(e))for(const o of e)if(isOptionsGroup(o))validateOptions(o.items,r);else{if(typeof o.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof o.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof o.value}`);if(r.has(o.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${o.value}" was provided more than once`);r.add(o.value)}}function isValueChecked(e,r){return Array.isArray(e)?e.includes(r):e===r}function Option({data:e,withCheckIcon:r,value:o,checkIconPosition:s,unstyled:a,renderOption:t}){if(!isOptionsGroup(e)){const l=isValueChecked(o,e.value),c=r&&l&&React.createElement(CheckIcon,{className:classes.optionsDropdownCheckIcon}),u=React.createElement(React.Fragment,null,s==="left"&&c,React.createElement("span",null,e.label),s==="right"&&c);return React.createElement(Combobox.Option,{value:e.value,disabled:e.disabled,className:clsx({[classes.optionsDropdownOption]:!a}),"data-reverse":s==="right"||void 0,"data-checked":l||void 0,"aria-selected":l,active:l},typeof t=="function"?t({option:e,checked:l}):u)}const n=e.items.map(l=>React.createElement(Option,{data:l,value:o,key:l.value,unstyled:a,withCheckIcon:r,checkIconPosition:s,renderOption:t}));return React.createElement(Combobox.Group,{label:e.group},n)}function OptionsDropdown({data:e,hidden:r,hiddenWhenEmpty:o,filter:s,search:a,limit:t,maxDropdownHeight:n,withScrollArea:l=!0,filterOptions:c=!0,withCheckIcon:u=!1,value:x,checkIconPosition:d,nothingFoundMessage:i,unstyled:f,labelId:v,renderOption:R,scrollAreaProps:w}){validateOptions(e);const C=typeof a=="string"?(s||defaultOptionsFilter)({options:e,search:c?a:"",limit:t??1/0}):e,y=isEmptyComboboxData(C),h=C.map(P=>React.createElement(Option,{data:P,key:isOptionsGroup(P)?P.group:P.value,withCheckIcon:u,value:x,checkIconPosition:d,unstyled:f,renderOption:R}));return React.createElement(Combobox.Dropdown,{hidden:r||o&&y},React.createElement(Combobox.Options,{labelledBy:v},l?React.createElement(ScrollArea.Autosize,{mah:n??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...w},h):h,y&&i&&React.createElement(Combobox.Empty,null,i)))}const defaultProps$1={multiple:!1},FileButton=reactExports.forwardRef((e,r)=>{const{onChange:o,children:s,multiple:a,accept:t,name:n,form:l,resetRef:c,disabled:u,capture:x,inputProps:d,...i}=useProps("FileButton",defaultProps$1,e),f=reactExports.useRef(),v=()=>{var g;!u&&((g=f.current)==null||g.click())},R=g=>{o(a?Array.from(g.currentTarget.files):g.currentTarget.files[0]||null)};return assignRef(c,()=>{f.current.value=""}),React.createElement(React.Fragment,null,s({onClick:v,...i}),React.createElement("input",{style:{display:"none"},type:"file",accept:t,multiple:a,onChange:R,ref:useMergedRef(r,f),name:n,form:l,capture:x,...d}))});FileButton.displayName="@mantine/core/FileButton";const defaultProps={searchable:!1,withCheckIcon:!0,allowDeselect:!0,checkIconPosition:"left"},Select=factory((e,r)=>{const o=useProps("Select",defaultProps,e),{classNames:s,styles:a,unstyled:t,vars:n,dropdownOpened:l,defaultDropdownOpened:c,onDropdownClose:u,onDropdownOpen:x,onFocus:d,onBlur:i,onClick:f,onChange:v,data:R,value:w,defaultValue:g,selectFirstOptionOnChange:C,onOptionSubmit:y,comboboxProps:h,readOnly:P,disabled:L,filter:q,limit:W,withScrollArea:Y,maxDropdownHeight:Z,size:M,searchable:m,rightSection:p,checkIconPosition:F,withCheckIcon:A,nothingFoundMessage:b,name:S,form:E,searchValue:j,defaultSearchValue:z,onSearchChange:N,allowDeselect:I,error:B,rightSectionPointerEvents:V,id:U,clearable:k,clearButtonProps:K,hiddenInputProps:X,renderOption:ee,onClear:oe,autoComplete:le,scrollAreaProps:ie,...se}=o,O=reactExports.useMemo(()=>getParsedComboboxData(R),[R]),Q=reactExports.useMemo(()=>getOptionsLockup(O),[O]),ne=useId(U),[D,re,ae]=useUncontrolled({value:w,defaultValue:g,finalValue:null,onChange:v}),J=typeof D=="string"?Q[D]:void 0,[te,H]=useUncontrolled({value:j,defaultValue:z,finalValue:J?J.label:"",onChange:N}),T=useCombobox({opened:l,defaultOpened:c,onDropdownOpen:()=>{x==null||x(),T.updateSelectedOptionIndex("active",{scrollIntoView:!0})},onDropdownClose:()=>{u==null||u(),T.resetSelectedOption()}}),{resolvedClassNames:ce,resolvedStyles:ue}=useResolvedStylesApi({props:o,styles:a,classNames:s});reactExports.useEffect(()=>{C&&T.selectFirstOption()},[C,D]),reactExports.useEffect(()=>{w===null&&H(""),typeof w=="string"&&J&&H(J.label)},[w,J]);const de=k&&!!D&&!L&&!P&&React.createElement(Combobox.ClearButton,{size:M,...K,onClear:()=>{re(null,null),H(""),oe==null||oe()}});return React.createElement(React.Fragment,null,React.createElement(Combobox,{store:T,__staticSelector:"Select",classNames:ce,styles:ue,unstyled:t,readOnly:P,onOptionSubmit:$=>{y==null||y($);const G=I&&Q[$].value===D?null:Q[$],pe=G?G.value:null;re(pe,G),!ae&&H(typeof pe=="string"&&(G==null?void 0:G.label)||""),T.closeDropdown()},size:M,...h},React.createElement(Combobox.Target,{targetType:m?"input":"button",autoComplete:le},React.createElement(InputBase,{id:ne,ref:r,rightSection:p||de||React.createElement(Combobox.Chevron,{size:M,error:B,unstyled:t}),rightSectionPointerEvents:V||(de?"all":"none"),...se,size:M,__staticSelector:"Select",disabled:L,readOnly:P||!m,value:te,onChange:$=>{H($.currentTarget.value),T.openDropdown(),C&&T.selectFirstOption()},onFocus:$=>{m&&T.openDropdown(),d==null||d($)},onBlur:$=>{var G;m&&T.closeDropdown(),H(D!=null&&((G=Q[D])==null?void 0:G.label)||""),i==null||i($)},onClick:$=>{m?T.openDropdown():T.toggleDropdown(),f==null||f($)},classNames:ce,styles:ue,unstyled:t,pointer:!m,error:B})),React.createElement(OptionsDropdown,{data:O,hidden:P||L,filter:q,search:te,limit:W,hiddenWhenEmpty:!m||!b,withScrollArea:Y,maxDropdownHeight:Z,filterOptions:m&&(J==null?void 0:J.label)!==te,value:D,checkIconPosition:F,withCheckIcon:A,nothingFoundMessage:b,unstyled:t,labelId:`${ne}-label`,renderOption:ee,scrollAreaProps:ie})),React.createElement(Combobox.HiddenInput,{value:D,name:S,form:E,disabled:L,...X}))});Select.classes={...InputBase.classes,...Combobox.classes};Select.displayName="@mantine/core/Select";/**
 * @license @tabler/icons-react v3.3.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconArrowsUpDown=createReactComponent("outline","arrows-up-down","IconArrowsUpDown",[["path",{d:"M7 3l0 18",key:"svg-0"}],["path",{d:"M10 6l-3 -3l-3 3",key:"svg-1"}],["path",{d:"M20 18l-3 3l-3 -3",key:"svg-2"}],["path",{d:"M17 21l0 -18",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.3.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconEraser=createReactComponent("outline","eraser","IconEraser",[["path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3",key:"svg-0"}],["path",{d:"M18 13.3l-6.3 -6.3",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.3.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var IconFileUpload=createReactComponent("outline","file-upload","IconFileUpload",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 11v6",key:"svg-2"}],["path",{d:"M9.5 13.5l2.5 -2.5l2.5 2.5",key:"svg-3"}]]);const ControlBar=e=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["        ",e.actions.map(r=>{if(r.hideIt)return"";const o=jsxRuntimeExports.jsxs(Button,{onClick:()=>{r.onClick&&r.onClick()},type:r.type,...r,children:[r.icon,r.text]});return r.title?jsxRuntimeExports.jsx(Tooltip,{label:r.title,children:o}):o})]}),PanelWithSideBar=e=>jsxRuntimeExports.jsxs(Flex,{className:"block sm:flex flex-row-reverse",p:0,align:"flex-start",justify:"space-between",children:[jsxRuntimeExports.jsx(Flex,{className:"w-[100%] sm:w-[250px]",p:10,children:e.sidebar}),jsxRuntimeExports.jsx(Flex,{direction:"column",flex:"1",children:e.main})]}),I18nSelect=e=>{var a;let s=(((a=apiSlice.useTlnGetI18nItemsQuery({}).data)==null?void 0:a.data)||[]).map(t=>({label:t.label[1],value:t.value}))||[];return!_.isEmpty(e.acceptValues)&&e.acceptValues&&(s=s.filter(t=>(e.acceptValues||[]).includes(t.value))),jsxRuntimeExports.jsx(Select,{name:e.name,placeholder:"请选择"+e.label,data:[...s],defaultValue:e.defaultValue,...e})},fn_translate_for_only_value=async(text,fn_translate)=>{const waitArr=[];function beforeTranslate(e){return e}function afterTranslate(e){return e}function translateEntireLogic(e,r){let o=(s,a,t)=>{if(_.isObject(s)||_.isArray(s)){_.forEach(s,o);return}waitArr.push((async()=>{let n=await r(s);t[a]=n,_.isObjectLike(t[a])||_.isArray(t[a])})())};_.forEach(e,o)}let currentJSONVal={};const tmpKeyJson="TMP_KEY_JSON";window[tmpKeyJson]||(window[tmpKeyJson]={});try{eval(`window['${tmpKeyJson}']  = ${text}`),currentJSONVal=window[tmpKeyJson]}catch(e){throw AlertUtils.alertErr("JSON格式错误，请检查您的输入是否正确"),new Error("JSON格式错误")}translateEntireLogic(currentJSONVal,fn_translate);for(let e=0;e<waitArr.length;e++)await waitArr[e];return JSON.stringify(currentJSONVal,null,4)},fn_translate_for_only_key=async(text,fn_translate)=>{let afterAllGoodsArr=[];const waitArr=[];function beforeTranslate(e){return e}function translateEntireLogic(e,r){let o=(s,a,t)=>{waitArr.push((async()=>{let n=a,l=_.kebabCase(a).replace(/_/g," ").trim(),c=await r(l);if(t[c+` | ${n}`]=s,afterAllGoodsArr.push(()=>{delete t[n]}),!_.isArray(s)){if(_.isObject(s)){_.forEach(s,o);return}}})())};_.forEach(e,o)}let currentJSONVal={};const tmpKeyJson="TMP_KEY_JSON2";window[tmpKeyJson]||(window[tmpKeyJson]={});try{eval(`window['${tmpKeyJson}']  = ${text}`),currentJSONVal=window[tmpKeyJson]}catch(e){throw AlertUtils.alertErr("JSON格式错误，请检查您的输入是否正确"),new Error("JSON格式错误")}translateEntireLogic(currentJSONVal,fn_translate);for(let e=0;e<waitArr.length;e++)await waitArr[e];for(let e=0;e<afterAllGoodsArr.length;e++)afterAllGoodsArr[e]();return JSON.stringify(currentJSONVal,null,4)},JSONTranslateMethods=[{label:"仅转换Value值",value:"ValueOnly",func:fn_translate_for_only_value},{label:"仅转换Key值",value:"KeyOnly",func:fn_translate_for_only_key},{label:"同时转换Key和Value值",value:"KeyAndValue",func:async(e,r)=>{let o=await fn_translate_for_only_value(e,r);return o=await fn_translate_for_only_key(o,r),o}}].map(e=>(e.label=e.label,e)),jsonExample=`{
    "timeLimitedAmount": "30010",
    "ruleId": "世界",
    "promotion-price": [12345,100,300],
    "discount_rate_limits": [12345,100,300],
    "apply_time_limits" : {
        "presentTitle": "仅转换Value值是在这里",
        "presentDetails": "仅转换Value值是在这里2",
salesRemarkMap: {
"subProductName":"minacz"
}
    }
}`,index=()=>(apiSlice.useLazyTlnSendRequestQuery({}),jsxRuntimeExports.jsx(CommonTLNBody,{saveDataId:"json",handleTranslate:async(e,r)=>{var a;let o=(a=JSONTranslateMethods.find(t=>t.value===e.translateMethod))==null?void 0:a.func;return o||(o=JSONTranslateMethods[0].func),await o(e.inputJSON,r)},id:"json",label:"JSON",example:jsonExample})),index$1=Object.freeze(Object.defineProperty({__proto__:null,JSONTranslateMethods,default:index,jsonExample},Symbol.toStringTag,{value:"Module"})),SimpleSelect=e=>jsxRuntimeExports.jsx(Select,{name:e.name,placeholder:"请选择"+e.label,data:e.dataArr||[],defaultValue:e.defaultValue,...e}),FileChoosePanel=e=>{const r=e.value,o=e.onChange;return jsxRuntimeExports.jsxs(Card,{withBorder:!0,className:"m-0 w-full",children:[jsxRuntimeExports.jsxs(Group,{justify:"center",children:[jsxRuntimeExports.jsx(FileButton,{onChange:o,multiple:!0,children:s=>jsxRuntimeExports.jsx(Button,{color:"green",...s,children:"上传所需文件(支持多选)"})}),jsxRuntimeExports.jsx(Button,{color:"gray",variant:"outline",onClick:()=>{o([])},children:"清空列表"})]}),r.length>0&&jsxRuntimeExports.jsx(Text,{size:"sm",mt:"sm",children:"已选文件:"}),jsxRuntimeExports.jsx("ul",{children:r.map((s,a)=>jsxRuntimeExports.jsx("li",{children:s.name},a))})]})},CommonTLNBody=e=>{var L,q,W,Y,Z,M;const r=e.id=="tlnztft",o=e.id=="json"||e.id=="json-comparison",s=reactExports.useRef({interval:null}),a=e.id=="markdown",t=exportUtils.register("tln"+e.saveDataId,{getPersistedStateFn:()=>e.defaultTLNPState||{sourceLang:"zh",targetLang:"en",translateMethod:JSONTranslateMethods[0].value,reservedWords:"",extraRequests:"",fillFileMode:!1},getNotPersistedStateFn:()=>({fanyiCount:1,fileProcessLabel:"当前任务处于闲置状态",inputJSON:"",outputJSON:"",selectedUploadFiles:[],detailForHandlingUploadFiles:{}})}),[n]=apiSlice.useLazyTlnSendRequestQuery({}),l=reactExports.useRef({lastTimestamp:-1,msgEventMap:{}}),c=(t==null?void 0:t.keyname)+e.id;useWebsocket("userchannel","tln"+c,{onMessage(m){m.id.startsWith("tln-res")&&_.forEach(l.current.msgEventMap,(p,F,A)=>{p(m)})}});const u=10,x=useClipboard({timeout:500}),[d,i]=reactExports.useState(!1),f=useDebouncedCallback(async()=>{R({eventSource:"input"})()},200);let v=()=>{e.realtime&&setTimeout(()=>{f()},0)};if(!t)return"";let R=m=>{let p=t.getActualValueInState();return async()=>{if(d&&m.eventSource=="submit"){AlertUtils.alertWarn("已取消本次翻译操作"),i(!1);return}i(!0);try{await t.checkLoginStatus();let A=Date.now();if(!p){AlertUtils.alertWarn("未知错误NIKQMINA");return}let b="";t.updateNonPState({fileProcessLabel:"正在处理文件中"});let S="";const E=async z=>{var k;const N=Date.now(),I=c+N+Date.now()+Math.random().toString(36).substring(7),B=new Promise((K,X)=>{l.current.msgEventMap[I]=async ee=>{switch(ee.id){case"tln-res-"+I:K(ee.value),delete l.current.msgEventMap[I];break}}});return await n({text:z+""||"",type:e.id+"",id:I+"",sourceLang:(p==null?void 0:p.sourceLang)+"",targetLang:(p==null?void 0:p.targetLang)+"",reservedWords:p==null?void 0:p.reservedWords,extraRequests:p==null?void 0:p.extraRequests}),((k=(await B).data)==null?void 0:k.result)||""};let j=0;if(window.clearInterval(s.current.interval),t.updateNonPState({fanyiCount:0}),s.current.interval=setInterval(()=>{j++,t.updateNonPState({fanyiCount:j})},1e3),p.fillFileMode){let z=1;const N=p.selectedUploadFiles;if(_.isEmpty(N)){AlertUtils.alertWarn("无文件可处理，请先选择文件");return}t.updateNonPState({fileProcessLabel:"开始处理本次翻译",detailForHandlingUploadFiles:{}});let I=0;for(let V of N)try{I++,AlertUtils.alertInfo(`正在翻译${V.name}中...`);let U=t.getActualValueInState();t.updateNonPState({fileProcessLabel:`处理中: ${I}/${N.length}`,detailForHandlingUploadFiles:{...U.detailForHandlingUploadFiles,[V.name]:{status:"pending"}}});const k=await readStrFromFile(V);z+=k.length;const K=`正在翻译中，预估字符${k.length}，请稍候`;AlertUtils.alertInfo(K),t.updateNonPState({fileProcessLabel:K});const X=await e.handleTranslate({...p,inputJSON:k},E);U=t.getActualValueInState(),t.updateNonPState({fileProcessLabel:`完成翻译处理: ${I}/${N.length}`,detailForHandlingUploadFiles:{...U.detailForHandlingUploadFiles,[V.name]:{status:"OK",result:X}}})}catch(U){const k=t.getActualValueInState();throw t.updateNonPState({fileProcessLabel:S,detailForHandlingUploadFiles:{...k.detailForHandlingUploadFiles,[V.name]:{status:"error",result:S}}}),U}const B="翻译"+N.length+"个文件完毕，总计"+z+"个字符，耗时"+((Date.now()-A)/1e3).toFixed(2)+"s";AlertUtils.alertSuccess(B),t.updateNonPState({fileProcessLabel:B})}else{if(p.inputJSON.length==0){t.updateNonPState({outputJSON:""}),AlertUtils.alertWarn("输入为空，请输入内容后重试");return}else b=await e.handleTranslate(p,E),t.updateNonPState({outputJSON:b});m.eventSource=="input"||b&&b.length!==0&&AlertUtils.alertSuccess("翻译完毕，总计"+b.length+"个字符，耗时"+((Date.now()-A)/1e3).toFixed(2)+"s")}}catch(A){throw A}finally{i(!1)}}};const w=e.translateActionItems?e.translateActionItems.map(m=>({...m})):[{type:"submit",text:d?`取消翻译(${Math.min(99,((L=t==null?void 0:t.npState)==null?void 0:L.fanyiCount)||0)})`:"开始翻译",color:d?"red":void 0,onClick:R({eventSource:"submit"})}],g=jsxRuntimeExports.jsx(Group,{wrap:"nowrap",children:jsxRuntimeExports.jsx(Textarea,{spellCheck:!1,w:"100%",placeholder:"请将需要翻译的"+e.label+"粘贴到这里",label:e.label+"输入",autosize:!0,resize:"both",minRows:u,maxRows:u,...t.bindOnChange({npStateKey:"inputJSON"},()=>{v()}),className:"overflow-auto"})}),C=(q=t==null?void 0:t.pState)==null?void 0:q.fillFileMode,y=jsxRuntimeExports.jsx(Group,{mt:10,wrap:"nowrap",justify:"space-between",children:jsxRuntimeExports.jsx(Group,{gap:7,children:jsxRuntimeExports.jsx(ControlBar,{actions:[...w,C?{color:"grape",text:"导出结果",onClick:()=>{var m;_.forEach((m=t==null?void 0:t.npState)==null?void 0:m.detailForHandlingUploadFiles,(p,F,A)=>{js_export_trigger({saveValue:p==null?void 0:p.result,filename:F})})}}:{color:"green",text:"复制结果",onClick:()=>{var m;x.copy(((m=t.npState)==null?void 0:m.outputJSON)||"无结果"),AlertUtils.alertSuccess("已复制到剪贴板")}},{color:"gray",hideIt:C,text:e.showExampleLabel?e.showExampleLabel:"示例"+e.label,onClick:()=>{t.updateNonPState({inputJSON:e.example}),v()}},(W=t==null?void 0:t.pState)!=null&&W.fillFileMode?{title:"返回文本编辑模式",color:"gray",text:"返回",variant:"outline",pl:12,pr:12,onClick:()=>{t.updatePState({fillFileMode:!1})}}:{title:"文件批处理模式",color:"gray",variant:"outline",pl:12,pr:12,icon:jsxRuntimeExports.jsx(IconFileUpload,{size:"15"}),onClick:()=>{t.updatePState({fillFileMode:!0})}},{color:"gray",variant:"outline",pl:12,hideIt:C,title:"交换上下文本框值",pr:12,icon:jsxRuntimeExports.jsx(IconArrowsUpDown,{size:"15"}),onClick:()=>{var m,p;t.updateNonPState({inputJSON:(m=t.npState)==null?void 0:m.outputJSON,outputJSON:(p=t.npState)==null?void 0:p.inputJSON})}},{color:"gray",variant:"outline",pl:12,hideIt:C,title:"清空上下文本框值",pr:12,icon:jsxRuntimeExports.jsx(IconEraser,{size:"15"}),onClick:()=>{t.updateNonPState({inputJSON:"",outputJSON:""})}}]})})}),h=jsxRuntimeExports.jsx(Group,{mt:10,wrap:"nowrap",children:jsxRuntimeExports.jsx(Textarea,{spellCheck:!1,w:"100%",label:`${e.label}输出`,placeholder:"翻译后的文本将会显示在这里",autosize:!0,resize:"both",minRows:u,...t.bindOnChange({npStateKey:"outputJSON"}),maxRows:u,name:"outputJSON"})}),P=r?["zh","zh-HK","zh-TW","zh"]:[];return jsxRuntimeExports.jsx(Container,{children:jsxRuntimeExports.jsx("form",{onSubmit:m=>{m.preventDefault()},children:jsxRuntimeExports.jsxs(Card,{withBorder:!0,shadow:"sm",radius:"md",children:[jsxRuntimeExports.jsx(Card.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:jsxRuntimeExports.jsx(Group,{justify:"center",children:jsxRuntimeExports.jsx(Text,{fw:500,children:d?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["正在翻译",e.label,"中",jsxRuntimeExports.jsx(Blink,{min:3,max:6})]}):e.label+"翻译工具"})})}),jsxRuntimeExports.jsx(PanelWithSideBar,{main:C?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[y,jsxRuntimeExports.jsxs(Group,{mt:10,gap:0,className:"flex flex-col items-start justify-start",flex:"flex-start ",children:[jsxRuntimeExports.jsx(Group,{children:jsxRuntimeExports.jsx(Text,{children:"待翻译列表"})}),jsxRuntimeExports.jsx(FileChoosePanel,{value:((Y=t==null?void 0:t.npState)==null?void 0:Y.selectedUploadFiles)||[],onChange:m=>{t.updateNonPState({selectedUploadFiles:m,detailForHandlingUploadFiles:{}})}})]}),jsxRuntimeExports.jsxs(Group,{mt:10,gap:0,className:"flex flex-col items-start justify-start",flex:"flex-start ",children:[jsxRuntimeExports.jsx(Text,{children:"翻译结果"}),jsxRuntimeExports.jsx(Text,{size:"xs",children:(Z=t==null?void 0:t.npState)==null?void 0:Z.fileProcessLabel}),jsxRuntimeExports.jsx(Card,{withBorder:!0,className:"w-full",children:jsxRuntimeExports.jsxs(Table,{children:[jsxRuntimeExports.jsx(Table.Thead,{children:jsxRuntimeExports.jsxs(Table.Tr,{children:[jsxRuntimeExports.jsx(Table.Th,{children:"名称"}),jsxRuntimeExports.jsx(Table.Th,{children:"类型/体积"}),jsxRuntimeExports.jsx(Table.Th,{children:"状态"}),jsxRuntimeExports.jsx(Table.Th,{children:"预览结果"}),jsxRuntimeExports.jsx(Table.Th,{children:"操作"})]})}),jsxRuntimeExports.jsx(Table.Tbody,{children:(M=t==null?void 0:t.npState)==null?void 0:M.selectedUploadFiles.map(m=>{var F;const p=(F=t==null?void 0:t.npState)==null?void 0:F.detailForHandlingUploadFiles[m.name];return jsxRuntimeExports.jsxs(Table.Tr,{children:[jsxRuntimeExports.jsx(Table.Td,{children:m.name}),jsxRuntimeExports.jsx(Table.Td,{children:m.size}),jsxRuntimeExports.jsx(Table.Td,{children:(p==null?void 0:p.status)||"无"}),jsxRuntimeExports.jsx(Table.Td,{children:_.truncate((p==null?void 0:p.result)||"无",{length:100})}),jsxRuntimeExports.jsxs(Table.Td,{children:[jsxRuntimeExports.jsx(Button,{size:"xs",color:"green",onClick:()=>{x.copy((p==null?void 0:p.result)||"无结果"),AlertUtils.alertSuccess("已复制此结果到剪贴板，文件名是"+m.name)},children:"复制"}),jsxRuntimeExports.jsx(Button,{size:"xs",color:"grape",onClick:()=>{js_export_trigger({saveValue:p==null?void 0:p.result,filename:m.name})},children:"导出"})]})]},m.name)})})]})})]})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[g,y,h]}),sidebar:jsxRuntimeExports.jsxs(Group,{gap:7,children:[jsxRuntimeExports.jsx(I18nSelect,{...t.bindOnChange({pStateKey:"sourceLang"}),acceptValues:P,label:"源语言",name:"sourceLang"}),jsxRuntimeExports.jsx(Group,{justify:"center",className:"ml-[-15px] w-full text-center",children:jsxRuntimeExports.jsx(Button,{size:"compact-xs",variant:"default",onClick:()=>{var m,p;t.updatePState({sourceLang:(m=t.pState)==null?void 0:m.targetLang,targetLang:(p=t.pState)==null?void 0:p.sourceLang})},children:jsxRuntimeExports.jsx(IconArrowsUpDown,{size:15})})}),jsxRuntimeExports.jsx(I18nSelect,{label:"目标语言",acceptValues:P,...t.bindOnChange({pStateKey:"targetLang"})}),o?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(SimpleSelect,{label:"JSON翻译方式",dataArr:JSONTranslateMethods,...t.bindOnChange({pStateKey:"translateMethod"})})}):"",a?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Textarea,{label:"保留词列表(可选)",className:"w-full",rows:5,placeholder:"如果您的文档中有一些词汇不希望被翻译，可以在这里填写，以逗号分隔",...t.bindOnChange({pStateKey:"reservedWords"})})}):""," ",a?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Textarea,{label:"额外要求(可选)",className:"w-full",rows:5,placeholder:"如果您有额外的翻译要求，请在这里填写，以便我们更好地为您服务",...t.bindOnChange({pStateKey:"extraRequests"})})}):"",e.extraOptionsJSX]})})]})})})};export{CommonTLNBody as C,JSONTranslateMethods as J,index$1 as i,jsonExample as j};
